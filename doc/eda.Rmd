---
title: "Wine Quality EDA"
output: github_document
---

#### Load libraries

```{r libraries}

library(tidyverse)

```

#### Import data

```{r dataImport}

tmp <- read_csv('data/cleaned_winequality-red.csv')
head(tmp)

```

#### EDA with all classes
Using `alcohol` as our feature of interest.

```{r}

# Check for unique values
unique(tmp$quality)

# Re-encode target for simplicity
test <- tmp %>%
  mutate(quality_ = case_when(
    quality == 3 ~ 1,
    quality == 4 ~ 2,
    quality == 5 ~ 3,
    quality == 6 ~ 4,
    quality == 7 ~ 5,
    quality == 8 ~ 6,
    TRUE ~ NA_real_
  ))

# Check amount of data for each value
test %>%
  group_by(quality_) %>%
  summarise(
    n = n()
  )

# Create violin plot
ggplot(test, aes(x = factor(x = quality_old), alcohol)) +
  geom_violin(fill = "#f8766d", alpha = 0.5) +
  geom_jitter(width = 0.4, alpha = 0.5, size = 0.75) +
  labs(x = "Quality",
       y = "Alcohol (%)") +
  theme_bw()

```

As you can see from our visualization, we have some issues with the amount of data we have in certain categories.  I would suggest that we consider re-encoding the data so that we only have two categories... something like "Poor" and "Good" --- which will be my placeholders for now!

#### EDA with two classes
Using `alcohol` as our feature of interest.

```{r}

# Re-encode for two classes
test <- tmp %>%
  mutate(quality_ = case_when(
    quality == 3 ~ 1,
    quality == 4 ~ 2,
    quality == 5 ~ 3,
    quality == 6 ~ 4,
    quality == 7 ~ 5,
    quality == 8 ~ 6,
    TRUE ~ NA_real_
  )) %>%
  mutate(quality_ = if_else(quality_ <= 3, "Poor", "Good"))

# Check amount of data for each class
test %>%
  group_by(quality_) %>%
  summarise(
    n = n()
  )

# Create a violin plot
ggplot(test, aes(x = factor(x = quality_), alcohol)) +
  geom_violin(fill = "#f8766d", alpha = 0.5) +
  geom_jitter(width = 0.4, alpha = 0.5, size = 1) +
  labs(x = "Quality (re-encoded)",
       y = "Alcohol (%)") +
  theme_bw()

```

The distribution of the data is much more balanced when we take the above approach.
Now, let's expand our exploration to include all features.

```{r}

### Explore all variables

test2 <- test %>%
  select(-quality) %>%
  gather(key = "characteristic", value = "value", -quality_)

ggplot(test2, aes(x = factor(x = quality_), value)) +
  geom_violin(fill = "#f8766d", alpha = 0.5) +
  scale_x_discrete(limits = c("Poor", "Good")) +
  facet_wrap(~characteristic, scales = "free") +
  labs(x = "Quality (re-encoded)",
       y = "") +
  theme_bw()

```

> To be continued...